!function(e){"use strict";class ProductionCollectionHelper{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now()},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this._initProxies(),this._initMutationObserver(),this._scheduleCleanup()}_initProxies(){this.ClassName=new Proxy(e=>{const t=this._getCollection("className",e);return new Proxy(t,{get:(e,t)=>{if(!isNaN(t)&&parseInt(t)>=0){const s=e[parseInt(t)];return s?new Proxy(s,{get:(e,t)=>e[t],set:(e,t,s)=>(e[t]=s,!0)}):s}return e[t]},set:(e,t,s)=>(e[t]=s,!0)})},{get:(e,t)=>"symbol"==typeof t||"function"==typeof e[t]?e[t]:this._getCollection("className",t),apply:(e,t,s)=>s.length>0?e(s[0]):this._createEmptyCollection()}),this.TagName=new Proxy(e=>{const t=this._getCollection("tagName",e);return new Proxy(t,{get:(e,t)=>{if(!isNaN(t)&&parseInt(t)>=0){const s=e[parseInt(t)];return s?new Proxy(s,{get:(e,t)=>e[t],set:(e,t,s)=>(e[t]=s,!0)}):s}return e[t]},set:(e,t,s)=>(e[t]=s,!0)})},{get:(e,t)=>"symbol"==typeof t||"function"==typeof e[t]?e[t]:this._getCollection("tagName",t),apply:(e,t,s)=>s.length>0?e(s[0]):this._createEmptyCollection()}),this.Name=new Proxy(e=>{const t=this._getCollection("name",e);return new Proxy(t,{get:(e,t)=>{if(!isNaN(t)&&parseInt(t)>=0){const s=e[parseInt(t)];return s?new Proxy(s,{get:(e,t)=>e[t],set:(e,t,s)=>(e[t]=s,!0)}):s}return e[t]},set:(e,t,s)=>(e[t]=s,!0)})},{get:(e,t)=>"symbol"==typeof t||"function"==typeof e[t]?e[t]:this._getCollection("name",t),apply:(e,t,s)=>s.length>0?e(s[0]):this._createEmptyCollection()})}_createCacheKey(e,t){return`${e}:${t}`}_getCollection(e,t){if("string"!=typeof t)return this._warn(`Invalid ${e} property type: ${typeof t}`),this._createEmptyCollection();const s=this._createCacheKey(e,t);if(this.cache.has(s)){const e=this.cache.get(s);if(this._isValidCollection(e))return this.stats.hits++,e;this.cache.delete(s)}let a;switch(e){case"className":a=document.getElementsByClassName(t);break;case"tagName":a=document.getElementsByTagName(t);break;case"name":a=document.getElementsByName(t);break;default:return this._warn(`Unknown collection type: ${e}`),this._createEmptyCollection()}const n=this._enhanceCollection(a,e,t);return this._addToCache(s,n),this.stats.misses++,n}_isValidCollection(e){if(!e||!e._originalCollection)return!1;const t=e._originalCollection;if(0===t.length)return!0;const s=t[0];return s&&document.contains(s)}_enhanceCollection(e,t,s){const a={_originalCollection:e,_type:t,_value:s,_cachedAt:Date.now(),get length(){return e.length},item:t=>e.item(t),namedItem:t=>e.namedItem?e.namedItem(t):null,toArray:()=>Array.from(e),forEach(t,s){Array.from(e).forEach(t,s)},map:(t,s)=>Array.from(e).map(t,s),filter:(t,s)=>Array.from(e).filter(t,s),find:(t,s)=>Array.from(e).find(t,s),some:(t,s)=>Array.from(e).some(t,s),every:(t,s)=>Array.from(e).every(t,s),first:()=>e.length>0?e[0]:null,last:()=>e.length>0?e[e.length-1]:null,at:t=>(t<0&&(t=e.length+t),t>=0&&t<e.length?e[t]:null),isEmpty:()=>0===e.length};for(let t=0;t<e.length;t++)Object.defineProperty(a,t,{get:()=>e[t],enumerable:!0});return a[Symbol.iterator]=function*(){for(let t=0;t<e.length;t++)yield e[t]},a}_createEmptyCollection(){return this._enhanceCollection({length:0,item:()=>null,namedItem:()=>null},"empty","")}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,this.weakCache.set(t,{cacheKey:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","name"]})}_processMutations(e){if(this.isDestroyed)return;const t=new Set,s=new Set,a=new Set;e.forEach(e=>{if([...e.addedNodes,...e.removedNodes].forEach(e=>{e.nodeType===Node.ELEMENT_NODE&&(e.className&&e.className.split(/\s+/).forEach(e=>{e&&t.add(e)}),e.name&&s.add(e.name),a.add(e.tagName.toLowerCase()),(e.querySelectorAll?e.querySelectorAll("*"):[]).forEach(e=>{e.className&&e.className.split(/\s+/).forEach(e=>{e&&t.add(e)}),e.name&&s.add(e.name),a.add(e.tagName.toLowerCase())}))}),"attributes"===e.type){const a=e.target;"class"===e.attributeName&&[...e.oldValue?e.oldValue.split(/\s+/):[],...a.className?a.className.split(/\s+/):[]].forEach(e=>{e&&t.add(e)}),"name"===e.attributeName&&(e.oldValue&&s.add(e.oldValue),a.name&&s.add(a.name))}});const n=[];for(const e of this.cache.keys()){const[i,o]=e.split(":",2);("className"===i&&t.has(o)||"name"===i&&s.has(o)||"tagName"===i&&a.has(o))&&n.push(e)}n.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,n.length>0&&this._log(`Invalidated ${n.length} cache entries due to DOM changes`)}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;const e=this.cache.size,t=[];for(const[e,s]of this.cache)this._isValidCollection(s)||t.push(e);t.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this._log(`Cleanup completed. Removed ${e-this.cache.size} stale entries.`)}_debounce(e,t){let s;return(...a)=>{clearTimeout(s),s=setTimeout(()=>e.apply(this,a),t)}}_log(e){this.options.enableLogging&&console.log(`[Collections] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Collections] ${e}`)}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Collections helper destroyed")}isCached(e,t){return this.cache.has(this._createCacheKey(e,t))}getCacheSnapshot(){return Array.from(this.cache.keys())}getMultiple(e){const t={};return e.forEach(({type:e,value:s,as:a})=>{const n=a||`${e}_${s}`;switch(e){case"className":t[n]=this.ClassName[s];break;case"tagName":t[n]=this.TagName[s];break;case"name":t[n]=this.Name[s]}}),t}async waitForElements(e,t,s=1,a=5e3){const n=Date.now();for(;Date.now()-n<a;){let a;switch(e){case"className":a=this.ClassName[t];break;case"tagName":a=this.TagName[t];break;case"name":a=this.Name[t];break;default:throw new Error(`Unknown collection type: ${e}`)}if(a&&a.length>=s)return a;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for ${e}="${t}" (min: ${s})`)}}const t=new ProductionCollectionHelper({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3}),Collections={ClassName:t.ClassName,TagName:t.TagName,Name:t.Name,helper:t,stats:()=>t.getStats(),clear:()=>t.clearCache(),destroy:()=>t.destroy(),isCached:(e,s)=>t.isCached(e,s),getMultiple:e=>t.getMultiple(e),waitFor:(e,s,a,n)=>t.waitForElements(e,s,a,n),configure:e=>(Object.assign(t.options,e),Collections)};"undefined"!=typeof module&&module.exports?module.exports={Collections:Collections,ProductionCollectionHelper:ProductionCollectionHelper}:"function"==typeof define&&define.amd?define([],function(){return{Collections:Collections,ProductionCollectionHelper:ProductionCollectionHelper}}):(e.Collections=Collections,e.ProductionCollectionHelper=ProductionCollectionHelper),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{t.destroy()})}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this);