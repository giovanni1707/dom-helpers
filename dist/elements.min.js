!function(e){"use strict";class ProductionElementsHelper{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now()},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this._initProxy(),this._initMutationObserver(),this._scheduleCleanup()}_initProxy(){this.Elements=new Proxy(this,{get:(e,t)=>e._getElement(t),has:(e,t)=>e._hasElement(t),ownKeys:e=>e._getKeys(),getOwnPropertyDescriptor:(e,t)=>{if(e._hasElement(t))return{enumerable:!0,configurable:!0,value:e._getElement(t)}}})}_findElementId(e){return e}_getElement(e){if("string"!=typeof e)return this._warn("Invalid element property type: "+typeof e),null;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&document.contains(t))return this.stats.hits++,t;this.cache.delete(e)}const t=document.getElementById(e);return t?(this._addToCache(e,t),this.stats.misses++,t):(this.stats.misses++,this._warn(`Element with id '${e}' not found`),null)}_hasElement(e){if("string"!=typeof e)return!1;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&document.contains(t))return!0;this.cache.delete(e)}return!!document.getElementById(e)}_getKeys(){return Array.from(document.querySelectorAll("[id]")).map(e=>e.id)}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,this.weakCache.set(t,{id:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id"]})}_processMutations(e){if(this.isDestroyed)return;const t=new Set,s=new Set;e.forEach(e=>{if(e.addedNodes.forEach(e=>{e.nodeType===Node.ELEMENT_NODE&&(e.id&&t.add(e.id),(e.querySelectorAll?.("[id]")||[]).forEach(e=>t.add(e.id)))}),e.removedNodes.forEach(e=>{e.nodeType===Node.ELEMENT_NODE&&(e.id&&s.add(e.id),(e.querySelectorAll?.("[id]")||[]).forEach(e=>s.add(e.id)))}),"attributes"===e.type&&"id"===e.attributeName){const i=e.oldValue,n=e.target.id;i&&i!==n&&s.add(i),n&&n!==i&&t.add(n)}}),t.forEach(e=>{const t=document.getElementById(e);t&&this._addToCache(e,t)}),s.forEach(e=>{this.cache.delete(e)}),this.stats.cacheSize=this.cache.size}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;const e=this.cache.size,t=[];for(const[e,s]of this.cache)s&&document.contains(s)||t.push(e);t.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this._log(`Cleanup completed. Removed ${e-this.cache.size} stale entries.`)}_debounce(e,t){let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>e.apply(this,i),t)}}_log(e){this.options.enableLogging&&console.log(`[Elements] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Elements] ${e}`)}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Elements helper destroyed")}isCached(e){return this.cache.has(e)}getCacheSnapshot(){return Array.from(this.cache.keys())}destructure(...e){const t={},s=[];return e.forEach(e=>{const i=this.Elements[e];i?t[e]=i:(s.push(e),t[e]=null)}),s.length>0&&this.options.enableLogging&&this._warn(`Missing elements during destructuring: ${s.join(", ")}`),t}getRequired(...e){const t=this.destructure(...e),s=e.filter(e=>!t[e]);if(s.length>0)throw new Error(`Required elements not found: ${s.join(", ")}`);return t}async waitFor(...e){const t=Date.now();for(;Date.now()-t<5e3;){const t=this.destructure(...e);if(e.every(e=>t[e]))return t;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for elements: ${e.join(", ")}`)}}const t=new ProductionElementsHelper({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3}),Elements=t.Elements;Elements.helper=t,Elements.stats=()=>t.getStats(),Elements.clear=()=>t.clearCache(),Elements.destroy=()=>t.destroy(),Elements.destructure=(...e)=>t.destructure(...e),Elements.getRequired=(...e)=>t.getRequired(...e),Elements.waitFor=(...e)=>t.waitFor(...e),Elements.isCached=e=>t.isCached(e),Elements.configure=e=>(Object.assign(t.options,e),Elements),"undefined"!=typeof module&&module.exports?module.exports={Elements:Elements,ProductionElementsHelper:ProductionElementsHelper}:"function"==typeof define&&define.amd?define([],function(){return{Elements:Elements,ProductionElementsHelper:ProductionElementsHelper}}):(e.Elements=Elements,e.ProductionElementsHelper=ProductionElementsHelper),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{t.destroy()})}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this);