/**
 * DOM Helpers - Combined Bundle (Unminified)
 * High-performance vanilla JavaScript DOM utilities with intelligent caching
 * 
 * Includes:
 * - Update Utility (Universal .update() method)
 * - Elements Helper (ID-based DOM access)
 * - Collections Helper (Class/Tag/Name-based DOM access)
 * - Selector Helper (querySelector/querySelectorAll with caching)
 * 
 * @version 2.1.0
 * @license MIT
 */
!function(e){"use strict";function t(e,t=!1){return function(i={}){return i&&"object"==typeof i?t?s(e,i):n(e,i):(console.warn("[DOM Helpers] .update() called with invalid updates object"),e)}}function n(e,t){if(!e||!e.nodeType)return console.warn("[DOM Helpers] .update() called on null or invalid element"),e;try{Object.entries(t).forEach(([t,n])=>{i(e,t,n)})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e}function s(e,t){if(!e)return console.warn("[DOM Helpers] .update() called on null collection"),e;let n=[];if(void 0!==e.length)n=Array.from(e);else if(e._originalCollection)n=Array.from(e._originalCollection);else{if(!e._originalNodeList)return console.warn("[DOM Helpers] .update() called on unrecognized collection type"),e;n=Array.from(e._originalNodeList)}if(0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{i(e,t,n)})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e}function i(e,t,n){try{if("style"===t&&"object"==typeof n&&null!==n)return void Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)});if("function"==typeof e[t])return void(Array.isArray(n)?e[t](...n):e[t](n));if(t in e)return void(e[t]=n);if("string"==typeof n||"number"==typeof n)return void e.setAttribute(t,n);console.warn(`[DOM Helpers] Unknown property or method: ${t}`)}catch(e){console.warn(`[DOM Helpers] Failed to apply update ${t}: ${e.message}`)}}function r(e){if(!e||e._hasUpdateMethod)return e;try{Object.defineProperty(e,"update",{value:t(e,!1),writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(n){e.update=t(e,!1),e._hasUpdateMethod=!0}return e}function o(e){if(!e||e._hasUpdateMethod)return e;try{Object.defineProperty(e,"update",{value:t(e,!0),writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(n){e.update=t(e,!0),e._hasUpdateMethod=!0}return e}function a(e){return e&&(void 0!==e.length||e._originalCollection||e._originalNodeList||e instanceof NodeList||e instanceof HTMLCollection)}const l={createUpdateMethod:t,enhanceElementWithUpdate:r,enhanceCollectionWithUpdate:o,autoEnhanceWithUpdate:function(e){return e?a(e)?o(e):e.nodeType===Node.ELEMENT_NODE?r(e):e:e},isCollection:a,updateSingleElement:n,updateCollection:s,applyUpdate:i};"undefined"!=typeof module&&module.exports?module.exports=l:"function"==typeof define&&define.amd?define([],function(){return l}):e.UpdateUtility=l;class ProductionElementsHelper{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now()},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this._initProxy(),this._initMutationObserver(),this._scheduleCleanup()}_initProxy(){this.Elements=new Proxy(this,{get:(e,t)=>"symbol"==typeof t||t.startsWith("_")||"function"==typeof e[t]?e[t]:e._getElement(t),has:(e,t)=>e._hasElement(t),ownKeys:e=>e._getKeys(),getOwnPropertyDescriptor:(e,t)=>{if(e._hasElement(t))return{enumerable:!0,configurable:!0,value:e._getElement(t)}}})}_getElement(e){if("string"!=typeof e)return this._warn("Invalid element property type: "+typeof e),null;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&t.nodeType===Node.ELEMENT_NODE&&document.contains(t))return this.stats.hits++,this._enhanceElementWithUpdate(t);this.cache.delete(e)}const t=document.getElementById(e);return t?(this._addToCache(e,t),this.stats.misses++,this._enhanceElementWithUpdate(t)):(this.stats.misses++,this.options.enableLogging&&this._warn(`Element with id '${e}' not found`),null)}_hasElement(e){if("string"!=typeof e)return!1;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&t.nodeType===Node.ELEMENT_NODE&&document.contains(t))return!0;this.cache.delete(e)}return!!document.getElementById(e)}_getKeys(){const e=document.querySelectorAll("[id]");return Array.from(e).map(e=>e.id).filter(e=>e)}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,this.weakCache.set(t,{id:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id"],attributeOldValue:!0}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id"],attributeOldValue:!0})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set,n=new Set;e.forEach(e=>{if(e.addedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){e.id&&t.add(e.id);try{(e.querySelectorAll?e.querySelectorAll("[id]"):[]).forEach(e=>{e.id&&t.add(e.id)})}catch(e){}}}),e.removedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){e.id&&n.add(e.id);try{(e.querySelectorAll?e.querySelectorAll("[id]"):[]).forEach(e=>{e.id&&n.add(e.id)})}catch(e){}}}),"attributes"===e.type&&"id"===e.attributeName){const s=e.oldValue,i=e.target.id;s&&s!==i&&n.add(s),i&&i!==s&&t.add(i)}}),t.forEach(e=>{const t=document.getElementById(e);t&&this._addToCache(e,t)}),n.forEach(e=>{this.cache.delete(e)}),this.stats.cacheSize=this.cache.size}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;this.cache.size;const e=[];for(const[t,n]of this.cache)n&&n.nodeType===Node.ELEMENT_NODE&&document.contains(n)&&n.id===t||e.push(t);e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_debounce(e,t){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}_log(e){this.options.enableLogging&&console.log(`[Elements] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Elements] ${e}`)}_enhanceElementWithUpdate(e){if(!e||e._hasUpdateMethod)return e;if(l&&l.enhanceElementWithUpdate)return l.enhanceElementWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},e._hasUpdateMethod=!0}return e}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Elements helper destroyed")}isCached(e){return this.cache.has(e)}getCacheSnapshot(){return Array.from(this.cache.keys())}destructure(...e){const t={},n=[];return e.forEach(e=>{const s=this.Elements[e];s?t[e]=s:(n.push(e),t[e]=null)}),n.length>0&&this.options.enableLogging&&this._warn(`Missing elements during destructuring: ${n.join(", ")}`),t}getRequired(...e){const t=this.destructure(...e),n=e.filter(e=>!t[e]);if(n.length>0)throw new Error(`Required elements not found: ${n.join(", ")}`);return t}async waitFor(...e){const t=Date.now();for(;Date.now()-t<5e3;){const t=this.destructure(...e);if(e.every(e=>t[e]))return t;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for elements: ${e.join(", ")}`)}get(e,t=null){return this.Elements[e]||t}exists(e){return!!this.Elements[e]}getMultiple(...e){return this.destructure(...e)}setProperty(e,t,n){const s=this.Elements[e];return!(!s||!(t in s)||(s[t]=n,0))}getProperty(e,t,n=void 0){const s=this.Elements[e];return s&&t in s?s[t]:n}setAttribute(e,t,n){const s=this.Elements[e];return!!s&&(s.setAttribute(t,n),!0)}getAttribute(e,t,n=null){const s=this.Elements[e];return s&&s.getAttribute(t)||n}}const c=new ProductionElementsHelper({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3}),Elements=c.Elements;Elements.helper=c,Elements.stats=()=>c.getStats(),Elements.clear=()=>c.clearCache(),Elements.destroy=()=>c.destroy(),Elements.destructure=(...e)=>c.destructure(...e),Elements.getRequired=(...e)=>c.getRequired(...e),Elements.waitFor=(...e)=>c.waitFor(...e),Elements.isCached=e=>c.isCached(e),Elements.get=(e,t)=>c.get(e,t),Elements.exists=e=>c.exists(e),Elements.getMultiple=(...e)=>c.getMultiple(...e),Elements.setProperty=(e,t,n)=>c.setProperty(e,t,n),Elements.getProperty=(e,t,n)=>c.getProperty(e,t,n),Elements.setAttribute=(e,t,n)=>c.setAttribute(e,t,n),Elements.getAttribute=(e,t,n)=>c.getAttribute(e,t,n),Elements.configure=e=>(Object.assign(c.options,e),Elements),"undefined"!=typeof module&&module.exports?module.exports={Elements:Elements,ProductionElementsHelper:ProductionElementsHelper}:"function"==typeof define&&define.amd?define([],function(){return{Elements:Elements,ProductionElementsHelper:ProductionElementsHelper}}):(e.Elements=Elements,e.ProductionElementsHelper=ProductionElementsHelper),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{c.destroy()});class ProductionCollectionHelper{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,enableEnhancedSyntax:e.enableEnhancedSyntax??!0,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now()},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this._initProxies(),this._initMutationObserver(),this._scheduleCleanup()}_initProxies(){this.ClassName=this._createCollectionProxy("className"),this.TagName=this._createCollectionProxy("tagName"),this.Name=this._createCollectionProxy("name")}_createCollectionProxy(e){return new Proxy(t=>{const n=this._getCollection(e,t);return this.options.enableEnhancedSyntax?this._createEnhancedCollectionProxy(n):n},{get:(t,n)=>{if("symbol"==typeof n||"constructor"===n||"prototype"===n||"apply"===n||"call"===n||"bind"===n||"function"==typeof t[n])return t[n];const s=this._getCollection(e,n);return this.options.enableEnhancedSyntax?this._createEnhancedCollectionProxy(s):s},apply:(e,t,n)=>n.length>0?e(n[0]):this._createEmptyCollection()})}_createEnhancedCollectionProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>{if(!isNaN(t)&&parseInt(t)>=0){const n=e[parseInt(t)];return n?this._createElementProxy(n):n}return e[t]},set:(e,t,n)=>{try{return e[t]=n,!0}catch(e){return this._warn(`Failed to set collection property ${t}: ${e.message}`),!1}}}):e}_createElementProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>e[t],set:(e,t,n)=>{try{return e[t]=n,!0}catch(e){return this._warn(`Failed to set element property ${t}: ${e.message}`),!1}}}):e}_createCacheKey(e,t){return`${e}:${t}`}_getCollection(e,t){if("string"!=typeof t)return this._warn(`Invalid ${e} property type: ${typeof t}`),this._createEmptyCollection();const n=this._createCacheKey(e,t);if(this.cache.has(n)){const e=this.cache.get(n);if(this._isValidCollection(e))return this.stats.hits++,e;this.cache.delete(n)}let s;try{switch(e){case"className":s=document.getElementsByClassName(t);break;case"tagName":s=document.getElementsByTagName(t);break;case"name":s=document.getElementsByName(t);break;default:return this._warn(`Unknown collection type: ${e}`),this._createEmptyCollection()}}catch(n){return this._warn(`Error getting ${e} collection for "${t}": ${n.message}`),this._createEmptyCollection()}const i=this._enhanceCollection(s,e,t);return this._addToCache(n,i),this.stats.misses++,i}_isValidCollection(e){if(!e||!e._originalCollection)return!1;const t=e._originalCollection;if(0===t.length)return!0;const n=t[0];return n&&n.nodeType===Node.ELEMENT_NODE&&document.contains(n)}_enhanceCollection(e,t,n){const s={_originalCollection:e,_type:t,_value:n,_cachedAt:Date.now(),get length(){return e.length},item:t=>e.item(t),namedItem:t=>e.namedItem?e.namedItem(t):null,toArray:()=>Array.from(e),forEach(t,n){Array.from(e).forEach(t,n)},map:(t,n)=>Array.from(e).map(t,n),filter:(t,n)=>Array.from(e).filter(t,n),find:(t,n)=>Array.from(e).find(t,n),some:(t,n)=>Array.from(e).some(t,n),every:(t,n)=>Array.from(e).every(t,n),reduce:(t,n)=>Array.from(e).reduce(t,n),first:()=>e.length>0?e[0]:null,last:()=>e.length>0?e[e.length-1]:null,at:t=>(t<0&&(t=e.length+t),t>=0&&t<e.length?e[t]:null),isEmpty:()=>0===e.length,addClass(e){return this.forEach(t=>t.classList.add(e)),this},removeClass(e){return this.forEach(t=>t.classList.remove(e)),this},toggleClass(e){return this.forEach(t=>t.classList.toggle(e)),this},setProperty(e,t){return this.forEach(n=>n[e]=t),this},setAttribute(e,t){return this.forEach(n=>n.setAttribute(e,t)),this},setStyle(e){return this.forEach(t=>{Object.assign(t.style,e)}),this},on(e,t){return this.forEach(n=>n.addEventListener(e,t)),this},off(e,t){return this.forEach(n=>n.removeEventListener(e,t)),this},visible(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&"0"!==t.opacity})},hidden(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility||"0"===t.opacity})},enabled(){return this.filter(e=>!e.disabled&&!e.hasAttribute("disabled"))},disabled(){return this.filter(e=>e.disabled||e.hasAttribute("disabled"))}};for(let t=0;t<e.length;t++)Object.defineProperty(s,t,{get:()=>e[t],enumerable:!0});return s[Symbol.iterator]=function*(){for(let t=0;t<e.length;t++)yield e[t]},this._enhanceCollectionWithUpdate(s)}_createEmptyCollection(){return this._enhanceCollection({length:0,item:()=>null,namedItem:()=>null},"empty","")}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,this.weakCache.set(t,{cacheKey:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","name"],attributeOldValue:!0}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","name"],attributeOldValue:!0})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set,n=new Set,s=new Set;e.forEach(e=>{if([...e.addedNodes,...e.removedNodes].forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){e.className&&e.className.split(/\s+/).forEach(e=>{e&&t.add(e)}),e.name&&n.add(e.name),s.add(e.tagName.toLowerCase());try{(e.querySelectorAll?e.querySelectorAll("*"):[]).forEach(e=>{e.className&&e.className.split(/\s+/).forEach(e=>{e&&t.add(e)}),e.name&&n.add(e.name),s.add(e.tagName.toLowerCase())})}catch(e){}}}),"attributes"===e.type){const s=e.target;"class"===e.attributeName&&[...e.oldValue?e.oldValue.split(/\s+/):[],...s.className?s.className.split(/\s+/):[]].forEach(e=>{e&&t.add(e)}),"name"===e.attributeName&&(e.oldValue&&n.add(e.oldValue),s.name&&n.add(s.name))}});const i=[];for(const e of this.cache.keys()){const[r,o]=e.split(":",2);("className"===r&&t.has(o)||"name"===r&&n.has(o)||"tagName"===r&&s.has(o))&&i.push(e)}i.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,i.length>0&&this.options.enableLogging&&this._log(`Invalidated ${i.length} cache entries due to DOM changes`)}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;this.cache.size;const e=[];for(const[t,n]of this.cache)this._isValidCollection(n)||e.push(t);e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_debounce(e,t){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}_log(e){this.options.enableLogging&&console.log(`[Collections] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Collections] ${e}`)}_enhanceCollectionWithUpdate(e){if(!e||e._hasUpdateMethod)return e;if(l&&l.enhanceCollectionWithUpdate)return l.enhanceCollectionWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let n=[];if(e._originalCollection?n=Array.from(e._originalCollection):void 0!==e.length&&(n=Array.from(e)),0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let n=[];if(e._originalCollection?n=Array.from(e._originalCollection):void 0!==e.length&&(n=Array.from(e)),0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},e._hasUpdateMethod=!0}return e}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Collections helper destroyed")}isCached(e,t){return this.cache.has(this._createCacheKey(e,t))}getCacheSnapshot(){return Array.from(this.cache.keys())}getMultiple(e){const t={};return e.forEach(({type:e,value:n,as:s})=>{const i=s||`${e}_${n}`;switch(e){case"className":t[i]=this.ClassName[n];break;case"tagName":t[i]=this.TagName[n];break;case"name":t[i]=this.Name[n]}}),t}async waitForElements(e,t,n=1,s=5e3){const i=Date.now();for(;Date.now()-i<s;){let s;switch(e){case"className":s=this.ClassName[t];break;case"tagName":s=this.TagName[t];break;case"name":s=this.Name[t];break;default:throw new Error(`Unknown collection type: ${e}`)}if(s&&s.length>=n)return s;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for ${e}="${t}" (min: ${n})`)}enableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!0,this}disableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!1,this}}const h=new ProductionCollectionHelper({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3,enableEnhancedSyntax:!0}),Collections={ClassName:h.ClassName,TagName:h.TagName,Name:h.Name,helper:h,stats:()=>h.getStats(),clear:()=>h.clearCache(),destroy:()=>h.destroy(),isCached:(e,t)=>h.isCached(e,t),getMultiple:e=>h.getMultiple(e),waitFor:(e,t,n,s)=>h.waitForElements(e,t,n,s),enableEnhancedSyntax:()=>h.enableEnhancedSyntax(),disableEnhancedSyntax:()=>h.disableEnhancedSyntax(),configure:e=>(Object.assign(h.options,e),Collections)};"undefined"!=typeof module&&module.exports?module.exports={Collections:Collections,ProductionCollectionHelper:ProductionCollectionHelper}:"function"==typeof define&&define.amd?define([],function(){return{Collections:Collections,ProductionCollectionHelper:ProductionCollectionHelper}}):(e.Collections=Collections,e.ProductionCollectionHelper=ProductionCollectionHelper),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{h.destroy()});class ProductionSelectorHelper{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,enableSmartCaching:e.enableSmartCaching??!0,enableEnhancedSyntax:e.enableEnhancedSyntax??!0,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now(),selectorTypes:new Map},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this.selectorPatterns=this._buildSelectorPatterns(),this._initProxies(),this._initMutationObserver(),this._scheduleCleanup()}_buildSelectorPatterns(){return{id:/^#([a-zA-Z][\w-]*)$/,class:/^\.([a-zA-Z][\w-]*)$/,tag:/^([a-zA-Z][a-zA-Z0-9]*)$/,attribute:/^\[([^\]]+)\]$/,descendant:/^(\w+)\s+(\w+)$/,child:/^(\w+)\s*>\s*(\w+)$/,pseudo:/^(\w+):([a-zA-Z-]+)$/}}_initProxies(){this.query=this._createQueryFunction("single"),this.queryAll=this._createQueryFunction("multiple"),this.options.enableEnhancedSyntax&&this._initEnhancedSyntax(),this.Scoped={within:(e,t)=>{const n="string"==typeof e?document.querySelector(e):e;if(!n)return null;const s=`scoped:${n.id||"anonymous"}:${t}`;return this._getScopedQuery(n,t,"single",s)},withinAll:(e,t)=>{const n="string"==typeof e?document.querySelector(e):e;if(!n)return this._createEmptyCollection();const s=`scopedAll:${n.id||"anonymous"}:${t}`;return this._getScopedQuery(n,t,"multiple",s)}}}_initEnhancedSyntax(){const e=this.query;this.query=new Proxy(e,{get:(e,t)=>{if("symbol"==typeof t||"constructor"===t||"prototype"===t||"apply"===t||"call"===t||"bind"===t||"function"==typeof e[t])return e[t];const n=this._normalizeSelector(t),s=this._getQuery("single",n);return s?this._createElementProxy(s):s},apply:(e,t,n)=>n.length>0?this._getQuery("single",n[0]):null});const t=this.queryAll;this.queryAll=new Proxy(t,{get:(e,t)=>{if("symbol"==typeof t||"constructor"===t||"prototype"===t||"apply"===t||"call"===t||"bind"===t||"function"==typeof e[t])return e[t];const n=this._normalizeSelector(t),s=this._getQuery("multiple",n);return this._createCollectionProxy(s)},apply:(e,t,n)=>n.length>0?this._getQuery("multiple",n[0]):this._createEmptyCollection()})}_createElementProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>e[t],set:(e,t,n)=>{try{return e[t]=n,!0}catch(e){return this._warn(`Failed to set property ${t}: ${e.message}`),!1}}}):e}_createCollectionProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>{if(!isNaN(t)&&parseInt(t)>=0){const n=e[parseInt(t)];return n?this._createElementProxy(n):n}return e[t]},set:(e,t,n)=>{try{return e[t]=n,!0}catch(e){return this._warn(`Failed to set collection property ${t}: ${e.message}`),!1}}}):e}_createQueryFunction(e){const t=t=>this._getQuery(e,t);return t._queryType=e,t._helper=this,t}_normalizeSelector(e){const t=e.toString(),n=e=>`.${this._camelToKebab(e)}`;return t.startsWith("id")&&t.length>2?(e=>`#${this._camelToKebab(e)}`)(t.slice(2)):t.startsWith("class")&&t.length>5?n(t.slice(5)):/^[a-z][a-zA-Z]*$/.test(t)&&/[A-Z]/.test(t)?n(t):/^[a-z]+$/.test(t)&&t.length<10?t:t.match(/^[a-zA-Z][\w-]*$/)?`#${t}`:t}_camelToKebab(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}_createCacheKey(e,t){return`${e}:${t}`}_getQuery(e,t){if("string"!=typeof t)return this._warn("Invalid selector type: "+typeof t),"single"===e?null:this._createEmptyCollection();const n=this._createCacheKey(e,t);if(this.cache.has(n)){const s=this.cache.get(n);if(this._isValidQuery(s,e))return this.stats.hits++,this._trackSelectorType(t),s;this.cache.delete(n)}let s;try{if("single"===e){const e=document.querySelector(t);s=this._enhanceElementWithUpdate(e)}else{const e=document.querySelectorAll(t);s=this._enhanceNodeList(e,t)}}catch(n){return this._warn(`Invalid selector "${t}": ${n.message}`),"single"===e?null:this._createEmptyCollection()}return this._addToCache(n,s),this.stats.misses++,this._trackSelectorType(t),s}_getScopedQuery(e,t,n,s){if(this.cache.has(s)){const e=this.cache.get(s);if(this._isValidQuery(e,n))return this.stats.hits++,e;this.cache.delete(s)}let i;try{if("single"===n)i=e.querySelector(t);else{const n=e.querySelectorAll(t);i=this._enhanceNodeList(n,t)}}catch(e){return this._warn(`Invalid scoped selector "${t}": ${e.message}`),"single"===n?null:this._createEmptyCollection()}return this._addToCache(s,i),this.stats.misses++,i}_isValidQuery(e,t){if("single"===t)return e&&e.nodeType===Node.ELEMENT_NODE&&document.contains(e);{if(!e||!e._originalNodeList)return!1;const t=e._originalNodeList;if(0===t.length)return!0;const n=t[0];return n&&document.contains(n)}}_enhanceNodeList(e,t){const n={_originalNodeList:e,_selector:t,_cachedAt:Date.now(),get length(){return e.length},item:t=>e.item(t),entries:()=>e.entries(),keys:()=>e.keys(),values:()=>e.values(),toArray:()=>Array.from(e),forEach(t,n){e.forEach(t,n)},map:(t,n)=>Array.from(e).map(t,n),filter:(t,n)=>Array.from(e).filter(t,n),find:(t,n)=>Array.from(e).find(t,n),some:(t,n)=>Array.from(e).some(t,n),every:(t,n)=>Array.from(e).every(t,n),reduce:(t,n)=>Array.from(e).reduce(t,n),first:()=>e.length>0?e[0]:null,last:()=>e.length>0?e[e.length-1]:null,at:t=>(t<0&&(t=e.length+t),t>=0&&t<e.length?e[t]:null),isEmpty:()=>0===e.length,addClass(e){return this.forEach(t=>t.classList.add(e)),this},removeClass(e){return this.forEach(t=>t.classList.remove(e)),this},toggleClass(e){return this.forEach(t=>t.classList.toggle(e)),this},setProperty(e,t){return this.forEach(n=>n[e]=t),this},setAttribute(e,t){return this.forEach(n=>n.setAttribute(e,t)),this},setStyle(e){return this.forEach(t=>{Object.assign(t.style,e)}),this},on(e,t){return this.forEach(n=>n.addEventListener(e,t)),this},off(e,t){return this.forEach(n=>n.removeEventListener(e,t)),this},visible(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&"0"!==t.opacity})},hidden(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility||"0"===t.opacity})},enabled(){return this.filter(e=>!e.disabled&&!e.hasAttribute("disabled"))},disabled(){return this.filter(e=>e.disabled||e.hasAttribute("disabled"))},within(e){const t=[];return this.forEach(n=>{const s=n.querySelectorAll(e);t.push(...Array.from(s))}),this._helper._enhanceNodeList(t,`${this._selector} ${e}`)}};for(let t=0;t<e.length;t++)Object.defineProperty(n,t,{get:()=>e[t],enumerable:!0});return n[Symbol.iterator]=function*(){for(let t=0;t<e.length;t++)yield e[t]},this._enhanceCollectionWithUpdate(n)}_createEmptyCollection(){const e=document.querySelectorAll("nonexistent-element-that-never-exists");return this._enhanceNodeList(e,"empty")}_trackSelectorType(e){const t=this._classifySelector(e),n=this.stats.selectorTypes.get(t)||0;this.stats.selectorTypes.set(t,n+1)}_classifySelector(e){return this.selectorPatterns.id.test(e)?"id":this.selectorPatterns.class.test(e)?"class":this.selectorPatterns.tag.test(e)?"tag":this.selectorPatterns.attribute.test(e)?"attribute":this.selectorPatterns.descendant.test(e)?"descendant":this.selectorPatterns.child.test(e)?"child":this.selectorPatterns.pseudo.test(e)?"pseudo":"complex"}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,t&&t.nodeType===Node.ELEMENT_NODE&&this.weakCache.set(t,{cacheKey:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){if(!this.options.enableSmartCaching)return;const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id","class","style","hidden","disabled"]}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id","class","style","hidden","disabled"]})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set;if(e.forEach(e=>{if("childList"===e.type&&t.add("*"),"attributes"===e.type){const n=e.target,s=e.attributeName;if("id"===s){const s=e.oldValue;s&&t.add(`#${s}`),n.id&&t.add(`#${n.id}`)}"class"===s&&[...e.oldValue?e.oldValue.split(/\s+/):[],...n.className?n.className.split(/\s+/):[]].forEach(e=>{e&&t.add(`.${e}`)}),t.add(`[${s}]`)}}),t.has("*"))this.cache.clear();else{const e=[];for(const n of this.cache.keys()){const[s,i]=n.split(":",2);for(const s of t)if(i.includes(s)){e.push(n);break}}e.forEach(e=>this.cache.delete(e))}this.stats.cacheSize=this.cache.size}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;this.cache.size;const e=[];for(const[t,n]of this.cache){const[s]=t.split(":",1);this._isValidQuery(n,"single"===s?"single":"multiple")||e.push(t)}e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_debounce(e,t){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>e.apply(this,s),t)}}_log(e){this.options.enableLogging&&console.log(`[Selector] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Selector] ${e}`)}_enhanceElementWithUpdate(e){if(!e||e._hasUpdateMethod)return e;if(l&&l.enhanceElementWithUpdate)return l.enhanceElementWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},e._hasUpdateMethod=!0}return e}_enhanceCollectionWithUpdate(e){if(!e||e._hasUpdateMethod)return e;if(l&&l.enhanceCollectionWithUpdate)return l.enhanceCollectionWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let n=[];if(e._originalNodeList?n=Array.from(e._originalNodeList):void 0!==e.length&&(n=Array.from(e)),0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let n=[];if(e._originalNodeList?n=Array.from(e._originalNodeList):void 0!==e.length&&(n=Array.from(e)),0===n.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,n])=>{"style"!==t||"object"!=typeof n||null===n?"function"!=typeof e[t]?t in e?e[t]=n:"string"!=typeof n&&"number"!=typeof n||e.setAttribute(t,n):Array.isArray(n)?e[t](...n):e[t](n):Object.entries(n).forEach(([t,n])=>{null!=n&&(e.style[t]=n)})})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},e._hasUpdateMethod=!0}return e}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup,selectorBreakdown:Object.fromEntries(this.stats.selectorTypes)}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this.stats.selectorTypes.clear(),this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Selector helper destroyed")}async waitForSelector(e,t=5e3){const n=Date.now();for(;Date.now()-n<t;){const t=this.query(e);if(t)return t;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for selector: ${e}`)}async waitForSelectorAll(e,t=1,n=5e3){const s=Date.now();for(;Date.now()-s<n;){const n=this.queryAll(e);if(n&&n.length>=t)return n;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for selector: ${e} (min: ${t})`)}enableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!0,this._initEnhancedSyntax(),this}disableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!1,this.query=this._createQueryFunction("single"),this.queryAll=this._createQueryFunction("multiple"),this}}const u=new ProductionSelectorHelper({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3,enableSmartCaching:!0,enableEnhancedSyntax:!0}),Selector={query:u.query,queryAll:u.queryAll,Scoped:u.Scoped,helper:u,stats:()=>u.getStats(),clear:()=>u.clearCache(),destroy:()=>u.destroy(),waitFor:(e,t)=>u.waitForSelector(e,t),waitForAll:(e,t,n)=>u.waitForSelectorAll(e,t,n),enableEnhancedSyntax:()=>u.enableEnhancedSyntax(),disableEnhancedSyntax:()=>u.disableEnhancedSyntax(),configure:e=>(Object.assign(u.options,e),Selector)};"undefined"!=typeof module&&module.exports?module.exports={Selector:Selector,ProductionSelectorHelper:ProductionSelectorHelper}:"function"==typeof define&&define.amd?define([],function(){return{Selector:Selector,ProductionSelectorHelper:ProductionSelectorHelper}}):(e.Selector=Selector,e.ProductionSelectorHelper=ProductionSelectorHelper),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{u.destroy()});const DOMHelpers={Elements:e.Elements,Collections:e.Collections,Selector:e.Selector,ProductionElementsHelper:e.ProductionElementsHelper,ProductionCollectionHelper:e.ProductionCollectionHelper,ProductionSelectorHelper:e.ProductionSelectorHelper,version:"2.0.0",isReady(){return!!(this.Elements&&this.Collections&&this.Selector)},getStats(){const stats={};return this.Elements&&"function"==typeof this.Elements.stats&&(stats.elements=this.Elements.stats()),this.Collections&&"function"==typeof this.Collections.stats&&(stats.collections=this.Collections.stats()),this.Selector&&"function"==typeof this.Selector.stats&&(stats.selector=this.Selector.stats()),stats},clearAll(){this.Elements&&"function"==typeof this.Elements.clear&&this.Elements.clear(),this.Collections&&"function"==typeof this.Collections.clear&&this.Collections.clear(),this.Selector&&"function"==typeof this.Selector.clear&&this.Selector.clear()},destroyAll(){this.Elements&&"function"==typeof this.Elements.destroy&&this.Elements.destroy(),this.Collections&&"function"==typeof this.Collections.destroy&&this.Collections.destroy(),this.Selector&&"function"==typeof this.Selector.destroy&&this.Selector.destroy()},configure(e={}){return this.Elements&&"function"==typeof this.Elements.configure&&this.Elements.configure(e.elements||e),this.Collections&&"function"==typeof this.Collections.configure&&this.Collections.configure(e.collections||e),this.Selector&&"function"==typeof this.Selector.configure&&this.Selector.configure(e.selector||e),this}};"undefined"!=typeof module&&module.exports?module.exports={DOMHelpers:DOMHelpers,Elements:e.Elements,Collections:e.Collections,Selector:e.Selector,ProductionElementsHelper:e.ProductionElementsHelper,ProductionCollectionHelper:e.ProductionCollectionHelper,ProductionSelectorHelper:e.ProductionSelectorHelper}:"function"==typeof define&&define.amd?define([],function(){return{DOMHelpers:DOMHelpers,Elements:e.Elements,Collections:e.Collections,Selector:e.Selector,ProductionElementsHelper:e.ProductionElementsHelper,ProductionCollectionHelper:e.ProductionCollectionHelper,ProductionSelectorHelper:e.ProductionSelectorHelper}}):e.DOMHelpers=DOMHelpers,"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{DOMHelpers.destroyAll()})}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this);